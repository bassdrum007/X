; 这是由AI为您整合和优化后的Clash分流策略文档
; 已将所有AI相关规则统一命名为“AI 服务”。
; 请根据您的实际节点和需求进行调整。

[custom]

; --- 规则 (Rules) ---
; 规则匹配顺序是从上到下，一旦命中便停止匹配。
; 因此，广告拦截和直连规则应优先放置。

; 广告拦截规则：优先处理，避免广告请求
ruleset=🛑 广告拦截,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/BanAD.list
ruleset=🛑 广告拦截,https://raw.githubusercontent.com/fmz200/wool_scripts/main/QuantumultX/filter/fenliu.list
ruleset=🛑 广告拦截,https://raw.githubusercontent.com/flyhigherpi/merlinclash_clash_related/master/Rules/ACL4SSR/Clash/BanProgramAD.list

; 直连规则：处理本地网络和明确需要直连的流量
ruleset=DIRECT,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/LocalAreaNetwork.list
ruleset=DIRECT,https://raw.githubusercontent.com/bassdrum007/X/refs/heads/master/Rules/Z-DirectRule.yaml

; --- 国内服务规则 ---
; 包含国内网站、苹果、微软和谷歌服务，这些服务通常优先直连或选择最优代理。

; 国内网站规则：主要用于国内服务，通常直连
ruleset=🇨🇳 国内网站,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/ChinaDomain.list
ruleset=🇨🇳 国内网站,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/ChinaCompanyIp.list
ruleset=🇨🇳 国内网站,https://raw.githubusercontent.com/flyhigherpi/merlinclash_clash_related/master/Rules/ACL4SSR/Clash/ChinaMedia.list
ruleset=🇨🇳 国内网站,https://raw.githubusercontent.com/flyhigherpi/merlinclash_clash_related/master/Rules/ACL4SSR/Clash/UnBan.list ; 整合国内列表，移除重复项
ruleset=🇨🇳 国内网站,[]GEOIP,LAN  ; 局域网流量通常直连
ruleset=🇨🇳 国内网站,[]GEOIP,CN ; 中国大陆IP流量直连

; --- 国外媒体与服务规则 ---
; 这些服务通常需要代理。
ruleset=❗ YouTube,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/YouTube/YouTube.list
ruleset=📺 Netflix,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Netflix/Netflix.list
ruleset=♨️ Lifestyle,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Instagram/Instagram.list
ruleset=♨️ Lifestyle,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Pinterest/Pinterest.list
ruleset=♨️ Lifestyle,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Twitter/Twitter.list
ruleset=♨️ Lifestyle,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Spotify/Spotify.list
ruleset=♨️ Lifestyle,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Facebook/Facebook.list
ruleset=♨️ Lifestyle,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/TikTok/TikTok.list
ruleset=♨️ Lifestyle,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/GitHub/GitHub.yaml

; AI 服务规则
ruleset=🤖 AI 服务,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/OpenAI/OpenAI.list
ruleset=🤖 AI 服务,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Gemini/Gemini.yaml
ruleset=🤖 AI 服务,https://raw.githubusercontent.com/CommonDist/Rules/b7f906936ec8dcba4fbad8b9768ba47b0186bc69/perplexity.list ; blackmatrix7目前没有独立的Perplexity规则，保留此规则
ruleset=🤖 AI 服务,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/ChatGPT/ChatGPT.list
ruleset=🤖 AI 服务,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Claude/Claude.list
ruleset=🤖 AI 服务,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Midjourney/Midjourney.list
ruleset=🤖 AI 服务,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/DeepL/DeepL.list
ruleset=🤖 AI 服务,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Notion/Notion.list
ruleset=🤖 AI 服务,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Zoom/Zoom.list ; Zoom虽然不是纯AI，但常用于国际会议，与AI服务场景相关
ruleset=🤖 AI 服务,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Grammarly/Grammarly.list ; 语法检查AI工具
ruleset=🤖 AI 服务,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Quora/Quora.list ; Quora上有大量AI相关内容和讨论

ruleset=⛩ 日韩媒体,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/DMM/DMM.list
ruleset=⛩ 日韩媒体,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Rakuten/Rakuten.list

; 苹果服务：通常直连或选择最优代理
ruleset=🍏 苹果服务,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Apple/Apple.list

; 微软服务：通常直连或选择最优代理
ruleset=💠 微软服务,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Microsoft/Microsoft.list
ruleset=💠 微软服务,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/OneDrive/OneDrive.list

; 谷歌服务：通常需要代理
ruleset=🌐 谷歌服务,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/Google/Google.list
ruleset=🌐 谷歌服务,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/GoogleDrive/GoogleDrive.list
ruleset=🌐 谷歌服务,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/GoogleEarth/GoogleEarth.list
ruleset=🌐 谷歌服务,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/GoogleFCM/GoogleFCM.list


; 最终规则：所有未被上述规则匹配的流量，都通过“漏网之鱼”组处理
ruleset=⭕ 漏网之鱼,[]FINAL


; --- 代理组 (Proxy Groups) ---
; 定义流量如何使用代理节点。
; 代理组的定义顺序非常重要：被引用的组必须先于引用它们的组被定义。

; 流量信息显示组：通常用于显示当前使用的节点流量信息
custom_proxy_group=📶 流量`select`(GB|Expire|Until|流量|到期|套餐|🈳|🈵|🉑)


; 总模式组：通过 url-test 自动优选所有可用代理组中的最佳节点
; 包含所有区域组、特殊节点和手动切换，以提供灵活的自动选择或手动干预
custom_proxy_group=🎯 总模式`url-test`[]🇭🇰 香港节点`[]🇼🇸 台湾节点`[]🇯🇵 日本节点`[]🇸🇬 狮城节点`[]🇺🇲 美国节点`[]🇰🇷 韩国节点`[]🛠️ 特殊节点`[]👉 手动切换`https://www.google.com/generate_204`120,,10


; 应用分组：将特定应用的流量路由到相应的代理组
; 顺序：优先推荐的区域节点 -> 其他区域节点 -> 总模式 -> 手动切换 -> 直连（部分应用不建议直连）
custom_proxy_group=❗ YouTube`select`[]🇼🇸 台湾节点`[]🇭🇰 香港节点`[]🇯🇵 日本节点`[]🇸🇬 狮城节点`[]🇺🇲 美国节点`[]🇰🇷 韩国节点`[]🎯 总模式`[]👉 手动切换`[]DIRECT`
custom_proxy_group=📺 Netflix`select`[]🇭🇰 香港节点`[]🇸🇬 狮城节点`[]🇯🇵 日本节点`[]🇺🇲 美国节点`[]🇼🇸 台湾节点`[]🇰🇷 韩国节点`[]🎯 总模式`[]👉 手动切换`[]DIRECT`
custom_proxy_group=♨️ Lifestyle`select`[]🎯 总模式`[]🇭🇰 香港节点`[]🇼🇸 台湾节点`[]🇯🇵 日本节点`[]🇸🇬 狮城节点`[]🇺🇲 美国节点`[]🇰🇷 韩国节点`[]👉 手动切换`[]DIRECT`
custom_proxy_group=🤖 AI 服务`select`[]🎯 总模式`[]🇭🇰 香港节点`[]🇼🇸 台湾节点`[]🇯🇵 日本节点`[]🇸🇬 狮城节点`[]🇺🇲 美国节点`[]🇰🇷 韩国节点`[]👉 手动切换`[]DIRECT`
custom_proxy_group=⛩ 日韩媒体`select`[]🇯🇵 日本节点`[]🎯 总模式`[]🇭🇰 香港节点`[]🇸🇬 狮城节点`[]🇼🇸 台湾节点`[]🇺🇲 美国节点`[]🇰🇷 韩国节点`[]👉 手动切换`[]DIRECT`

; 国内服务和直连：这些服务通常可以直连，也可以通过总模式进行代理
custom_proxy_group=🍏 苹果服务`select`[]DIRECT`[]🎯 总模式`[]🇭🇰 香港节点`[]🇼🇸 台湾节点`[]🇯🇵 日本节点`[]🇸🇬 狮城节点`[]🇺🇲 美国节点`[]🇰🇷 韩国节点`[]👉 手动切换`
custom_proxy_group=💠 微软服务`select`[]DIRECT`[]🎯 总模式`[]🇭🇰 香港节点`[]🇼🇸 台湾节点`[]🇯🇵 日本节点`[]🇸🇬 狮城节点`[]🇺🇲 美国节点`[]🇰🇷 韩国节点`[]👉 手动切换`
custom_proxy_group=🌐 谷歌服务`select`[]🎯 总模式`[]DIRECT`[]🇭🇰 香港节点`[]🇼🇸 台湾节点`[]🇯🇵 日本节点`[]?🇬 狮城节点`[]🇺🇲 美国节点`[]🇰🇷 韩国节点`[]👉 手动切换`
custom_proxy_group=🇨🇳 国内网站`select`[]DIRECT`[]🎯 总模式`[]🇭🇰 香港节点`[]🇼🇸 台湾节点`[]🇯🇵 日本节点`[]🇸🇬 狮城节点`[]🇺🇲 美国节点`[]🇰🇷 韩国节点`[]👉 手动切换`

; 区域节点组：通过 url-test 自动选择延迟最低的节点
; 测试间隔 120 秒，连续 10 次失败则标记为不可用
custom_proxy_group=🇭🇰 香港节点`url-test`(港|HK|Hong Kong)`https://www.google.com/generate_204`120,,10
custom_proxy_group=🇼🇸 台湾节点`url-test`(台|新北|彰化|TW|Taiwan)`https://www.google.com/generate_204`120,,10
custom_proxy_group=🇯🇵 日本节点`url-test`(日本|川日|东京|大阪|泉日|埼玉|沪日|深日|[^-]JP|Japan)`https://www.google.com/generate_204`120,,10
custom_proxy_group=🇰🇷 韩国节点`url-test`(KR|Korea|KOR|首尔|韩|韓)`https://www.google.com/generate_204`120,,10
custom_proxy_group=🇸🇬 狮城节点`url-test`(新加坡|坡|狮城|SG|Singapore)`https://www.google.com/generate_204`120,,10
custom_proxy_group=🇺🇲 美国节点`url-test`(美|波特兰|达拉斯|俄勒冈|凤凰城|费利蒙|硅谷|拉斯维加斯|洛杉矶|圣何塞|圣克拉拉|西雅图|芝加哥|US|United States)`https://www.google.com/generate_204`120,,10

; 特殊节点组：用于排除其他已知区域后的节点，可能需要手动选择
; 请确保您的节点命名规范能准确匹配此复杂正则表达式
custom_proxy_group=🛠️ 特殊节点`select`(^(?!.*(500|Day|Expire|Traffic|Until|剩余|流量|到期|🈳|🈵|🉑|港|HK|Hong Kong|台|新北|彰化|TW|Taiwan|日本|川日|东京|大阪|泉日|埼玉|沪日|深日|[^-]JP|Japan|KR|Korea|KOR|首尔|韩|韓|新加坡|坡|狮城|SG|Singapore|美|波特兰|达拉斯|俄勒冈|凤凰城|费利蒙|硅谷|拉斯维加斯|洛杉矶|圣何塞|圣克拉拉|西雅图|芝加哥|US|United States)).*)

; 手动切换组：允许用户手动选择特定的节点或区域
custom_proxy_group=👉 手动切换`select`(港|HK|Hong Kong|台|新北|彰化|TW|Taiwan|日本|川日|东京|大阪|泉日|埼玉|沪日|深日|[^-]JP|Japan|新加坡|坡|狮城|SG|Singapore|美|波特兰|达拉斯|俄勒冈|凤凰城|费利蒙|硅谷|拉斯维加斯|洛杉矶|圣何塞|圣克拉拉|西雅图|芝加哥|US|United States)

; 广告拦截和漏网之鱼：确保广告被拒绝，未匹配的流量有默认路由
custom_proxy_group=🛑 广告拦截`select`[]REJECT`[]DIRECT`
custom_proxy_group=⭕ 漏网之鱼`select`[]🎯 总模式`[]🇭🇰 香港节点`[]🇼🇸 台湾节点`[]🇯🇵 日本节点`[]🇸🇬 狮城节点`[]🇺🇲 美国节点`[]🇰🇷 韩国节点`[]👉 手动切换`[]DIRECT`

; --- Clash 配置末尾项 ---
enable_rule_generator=true
overwrite_original_rules=true
; clash_rule_base=https://raw.gitcode.com/bassdrum/Z/raw/main/GeneralClashConfig.yml
